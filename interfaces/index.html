<!DOCTYPE html>
<html lang="en">

<head>
    <title>Happiness</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Custom CSS -->
    <link href="vendor/scrolling-nav/scrolling-nav.css" rel="stylesheet">

    <!-- font awesome -->
    <link href="https://opensource.keycdn.com/fontawesome/4.6.3/font-awesome.min.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <!-- google fonts -->
    <link href="https://fonts.googleapis.com/css?family=Indie+Flower|Fira+Sans" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="style.css" />

    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="vendor/d3-promise/es6-promise.js"></script>
    <script src="vendor/d3-promise/d3.promise.js"></script>

    <!-- Added so that the script in the control section would load afher the document is ready -->
    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.1.0.js" integrity="sha256-slogkvB1K3VOkzAI8QITxV3VzpOnkeNVsKvtkYLMjfk=" crossorigin="anonymous"></script>




    <script src="vendor/knop/jquery.knob.min.js"></script>
    <script src="functions/sortingDataset.js"></script>
    <script src="functions/userData.js"></script>
    <script src="functions/circleKnop.js"></script>
    <script src="functions/timeUse.js"></script>

    <script src="timeToHappiness.js"></script>


</head>

<!-- The #page-top ID is part of the scrolling feature - the data-spy and data-target are part of the built-in Bootstrap scrollspy function -->

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand page-scroll handwrite text-danger" href="#page-top">Time for Happiness</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    <!-- Hidden li included to remove active class from about link when scrolled up past about section -->
                    <li class="hidden">
                        <a class="page-scroll" href="#page-top"></a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#about">Gender selection</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#services">Country selection</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#contact">What if...</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Intro Section -->
    <section id="intro" class="intro-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="container text-center">
                    <h2>
                        What if
                        <span id="rotate1" class="handwrite"> <span>sleeping</span> <span>reading books</span> <span>cleaning</span> <span>participating in parties</span> <span>playing video games</span><span>doing gardening</span> <span>listening to the radio</span> <span>ironing</span> <span>visiting your friends</span> <span>playing piano</span> <span>walking the dog</span> <span>travelling</span> <span>washing your dishes</span> <span>watching tv</span> </span>
                        <span id="rotate2" class="handwrite"> <span>2</span> <span>12</span> <span>8</span> <span>21</span> <span>2</span> <span>23</span> <span>3</span> <span>12</span> <span>19</span> <span>4</span> <span>7</span></span>
                        <span id="rotate3" class="handwrite"> <span>hours</span> <span>seconds</span> <span>minutes</span> <span>milliseconds</span></span>
                        <span id="rotate4" class="handwrite"> <span>more</span> <span>less</span>  <span>less</span>  <span>more</span> <span>less</span> </span>
                        can make you
                        <h1 class="happier handwrite text-danger">happier?</h1>
                    </h2>
                    <br>
                    <br>
                    <a class="btn btn-danger btn-lg page-scroll" href="#about" style="padding: 28px 38px;">Let me know how! <i class="fa fa-heart" aria-hidden="true"></i></a>
                </div>
            </div>
        </div>
    </section>

    <!-- Gender Section -->
    <section id="about" class="about-section">
        <div class="container text-center">
            <div class="row">
                <div class="col-lg-12">
                    <h1>Are you...</h1>
                </div>
            </div>
            <div class="row">
                <a class="btn text-danger" id="femaleButton">
                    <i class="fa fa-venus" aria-hidden="true"></i>
                </a>
                <a class="btn text-danger" id="maleButton">
                    <i class="fa fa-mars" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Country Section -->
    <section id="services" class="services-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h1>Select your Country</h1>
                    <h3 class="handwrite text-danger">Red highlighted countries are available</h3>
                    <div id="map" style="position: relative; width: 100%; height: 800px;"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact-section">
        <div class="container">
            <div class="row">
                <h1>Play with your time</h1>
                <div class="col-lg-4">&nbsp;</div>
                <div class="col-lg-4">
                    <div id="knopInterface">
                        <h2 id="title" class="handwrite text-danger"></h2>
                            <div style="display: flex;">
                                <button class="flat-button circleButton" id="left" style="border:none;"><i class="fa fa-chevron-left fa-2x"  aria-hidden="true"></i></button>

                                <input type="text" value="75" class="dial">

                                <button class="flat-button circleButton" style="border:none;" id="right"><i class="fa fa-chevron-right fa-2x"  aria-hidden="true"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">&nbsp;</div>
            </div>
            <div class="row">
                    <div class="col-lg-4">
                        <h2 class="handwrite">Average happiness score</h2>
                            <div id="barsContainer">
                                <svg height="1000" width="1000"></svg>
                            </div>

                    <script>
                        $( document ).ready(function() {
                           // timeUse.draw();
                        });
                    </script>
                </div>
                <div class="col-lg-6">
                    <h2 class="handwrite">Average time usage in your country</h2>
                    <div id="main">
                        <div id="sequence"></div>
                        <div id="chart">
                            <div id="explanation" style="visibility: hidden;">
                                <span id="percentage"></span><br/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2">
                    <div id="sidebar">
                        <input type="checkbox" id="togglelegend"> Legend<br/>
                        <div id="legend"></div>
                    </div>
                </div>
            </div>


        </div>
    </section>


    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


    <!-- Scrolling Nav JavaScript -->
    <script src="vendor/scrolling-nav/jquery.easing.min.js"></script>
    <script src="vendor/scrolling-nav/scrolling-nav.js"></script>


    <script src="vendor/lodash/lodash.js"></script>
    <script src="vendor/moment/moment-with-locales.js"></script>
    <script src="vendor/numeral/numeral.min.js"></script>


    <script>
        (function($){
            $.fn.extend({
                rotaterator: function(options) {

                    var defaults = {
                        fadeSpeed: 500,
                        pauseSpeed: 100,
                        child:null
                    };

                    var options = $.extend(defaults, options);

                    return this.each(function() {
                        var o =options;
                        var obj = $(this);
                        var items = $(obj.children(), obj);
                        items.each(function() {$(this).hide();})
                        if(!o.child){var next = $(obj).children(':first');
                        }else{var next = o.child;
                        }
                        $(next).fadeIn(o.fadeSpeed, function() {
                            $(next).delay(o.pauseSpeed).fadeOut(o.fadeSpeed, function() {
                                var next = $(this).next();
                                if (next.length == 0){
                                    next = $(obj).children(':first');
                                }
                                $(obj).rotaterator({child : next, fadeSpeed : o.fadeSpeed, pauseSpeed : o.pauseSpeed});
                            })
                        });
                    });
                }
            });
        })(jQuery);

        $(document).ready(function() {
            $('#rotate1').rotaterator({fadeSpeed:500, pauseSpeed:4000});
            $('#rotate2').rotaterator({fadeSpeed:500, pauseSpeed:8000});
            $('#rotate3').rotaterator({fadeSpeed:500, pauseSpeed:10000});
            $('#rotate4').rotaterator({fadeSpeed:500, pauseSpeed:6000});

        });
    </script>


    <!-- datamaps -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
    <script src="vendor/datamaps/datamaps.world.min.js"></script>
    <script>
        var _map = new Datamap({
            element: document.getElementById("map"),
            scope: 'world',
            // Zoom in on Africa
            setProjection: function(element) {
                var projection = d3.geo.equirectangular()
                        .center([15, 53])
                        .rotate([4.4, 0])
                        .scale(1200)
                        .translate([element.offsetWidth / 2, element.offsetHeight / 2]);
                var path = d3.geo.path()
                        .projection(projection);

                return {path: path, projection: projection};
            },
            fills: {
                defaultFill: "#EEE",
                'red': '#A94442'
            },
            data: {
                'BEL': { fillKey: 'red' },
                'BGR': { fillKey: 'red' },
                'DEU': { fillKey: 'red' },
                'EST': { fillKey: 'red' },
                'ESP': { fillKey: 'red' },
                'FRA': { fillKey: 'red' },
                'ITA': { fillKey: 'red' },
                'LVA': { fillKey: 'red' },
                'LTU': { fillKey: 'red' },
                'POL': { fillKey: 'red' },
                'SVN': { fillKey: 'red' },
                'FIN': { fillKey: 'red' },
                'GBR': { fillKey: 'red' },
                'NOR': { fillKey: 'red' }
            }
        });

        d3.selectAll('.datamaps-subunit[data-info]').on('click', function(data) {
            console.log(data);
            window._selectedCountry=data;
            $(function() {
                    $('html, body').stop().animate({
                        scrollTop: $('#contact').offset().top
                    }, 1500, 'easeInOutExpo');
            });

            drawSun();
        });

        d3.selectAll('.datamaps-subunit:not([data-info])').on('click', function(data) {
            alert("Sorry, data not available, please try again :)")
        });



        function drawSun(){


            // Dimensions of sunburst.
            var width = 600;
            var height = 400;
            var radius = Math.min(width, height) / 2;

            // Breadcrumb dimensions: width, height, spacing, width of tip/tail.
            var b = {
                w: 200, h: 30, s: 3, t: 10
            };

            // Mapping of step names to colors.
            var colors = {
                "Personal care": "#5687d1",
                "Employment": "#7b615c",
                "Study": "#de783b",
                "Household and family care": "#6ab975",
                "Leisure and social life": "#a173d1"
            };

            // Total size of all segments; we set this later, after loading the data.
            var totalSize = 0;

            var vis = d3.select("#chart").append("svg:svg")
                    .attr("width", width)
                    .attr("height", height)
                    .append("svg:g")
                    .attr("id", "container")
                    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

            var partition = d3.layout.partition()
                    .size([2 * Math.PI, radius * radius])
                    .value(function(d) { return d.size; });

            var arc = d3.svg.arc()
                    .startAngle(function(d) { return d.x; })
                    .endAngle(function(d) { return d.x + d.dx; })
                    .innerRadius(function(d) { return Math.sqrt(d.y); })
                    .outerRadius(function(d) { return Math.sqrt(d.y + d.dy); });

            // Use d3.text and d3.csv.parseRows so that we do not need to have a header
            // row, and can receive the csv as an array of arrays.


            var _dataset="";

            if(window._selectedGender === "male"){
                _dataset="datasets/maleTimeHappynessDataset.csv"
            } else {
                _dataset="datasets/femaleTimeHappynessDataset.csv"
            }

            d3.csv(_dataset, function(data) {
                var csv = data;
                var json = buildHierarchy(csv);
                createVisualization(json);
            });


            // Main function to draw and set up the visualization, once we have the data.
            function createVisualization(json) {




                // Basic setup of page elements.
                initializeBreadcrumbTrail();
                drawLegend();
                d3.select("#togglelegend").on("click", toggleLegend);

                // Bounding circle underneath the sunburst, to make it easier to detect
                // when the mouse leaves the parent g.
                vis.append("svg:circle")
                        .attr("r", radius)
                        .style("opacity", 0);

                // For efficiency, filter nodes to keep only those large enough to see.
                var nodes = partition.nodes(json)
                        .filter(function(d) {
                            return (d.dx > 0.005); // 0.005 radians = 0.29 degrees
                        });

                var path = vis.data([json]).selectAll("path")
                        .data(nodes)
                        .enter().append("svg:path")
                        .attr("display", function(d) { return d.depth ? null : "none"; })
                        .attr("d", arc)
                        .attr("fill-rule", "evenodd")
                        .style("fill", function(d) {
                            console.log(d)
                            if(colors[d.name]!=undefined){
                                return colors[d.name]
                            } else if (d.parent!=undefined && colors[d.parent.name]!=undefined){
                                return colors[d.parent.name];
                            } else {
                                return;
                            }
                        })
                        .style("opacity", 1)
                        .on("mouseover", mouseover);

                // Add the mouseleave handler to the bounding circle.
                d3.select("#container").on("mouseleave", mouseleave);

                // Get total size of the tree = value of root node from partition.
                totalSize = path.node().__data__.value;
            };

            // Fade all but the current sequence, and show it in the breadcrumb trail.
            function mouseover(d) {
                var percentage = (100 * d.value / totalSize).toPrecision(3);
                var percentageString = minutesToTime(d.value) + " [" + percentage + "%" + "]";
                if (percentage < 0.1) {
                    percentageString = minutesToTime(d.value) + " [" + "< 0.1%" + "]";
                }

                d3.select("#percentage")
                        .text(percentageString);

                d3.select("#explanation")
                        .style("visibility", "");

                var sequenceArray = getAncestors(d);
                updateBreadcrumbs(sequenceArray, percentageString);

                // Fade all the segments.
                d3.selectAll("path")
                        .style("opacity", 0.3);

                // Then highlight only those that are an ancestor of the current segment.
                vis.selectAll("path")
                        .filter(function(node) {
                            return (sequenceArray.indexOf(node) >= 0);
                        })
                        .style("opacity", 1);
            }

            // Restore everything to full opacity when moving off the visualization.
            function mouseleave(d) {

                // Hide the breadcrumb trail
                d3.select("#trail")
                        .style("visibility", "hidden");

                // Deactivate all segments during transition.
                d3.selectAll("path").on("mouseover", null);

                // Transition each segment to full opacity and then reactivate it.
                d3.selectAll("path")
                        .transition()
                        .duration(1000)
                        .style("opacity", 1)
                        .each("end", function() {
                            d3.select(this).on("mouseover", mouseover);
                        });

                d3.select("#explanation")
                        .style("visibility", "hidden");
            }

            // Given a node in a partition layout, return an array of all of its ancestor
            // nodes, highest first, but excluding the root.
            function getAncestors(node) {
                var path = [];
                var current = node;
                while (current.parent) {
                    path.unshift(current);
                    current = current.parent;
                }
                return path;
            }

            function initializeBreadcrumbTrail() {
                // Add the svg area.
                var trail = d3.select("#sequence").append("svg:svg")
                        .attr("width", width)
                        .attr("height", 50)
                        .attr("id", "trail");
                // Add the label at the end, for the percentage.
                trail.append("svg:text")
                        .attr("id", "endlabel")
                        .style("fill", "#000");
            }

            // Generate a string that describes the points of a breadcrumb polygon.
            function breadcrumbPoints(d, i) {
                var points = [];
                points.push("0,0");
                points.push(b.w + ",0");
                points.push(b.w + b.t + "," + (b.h / 2));
                points.push(b.w + "," + b.h);
                points.push("0," + b.h);
                if (i > 0) { // Leftmost breadcrumb; don't include 6th vertex.
                    points.push(b.t + "," + (b.h / 2));
                }
                return points.join(" ");
            }

            // Update the breadcrumb trail to show the current sequence and percentage.
            function updateBreadcrumbs(nodeArray, percentageString) {

                // Data join; key function combines name and depth (= position in sequence).
                var g = d3.select("#trail")
                        .selectAll("g")
                        .data(nodeArray, function(d) { return d.name + d.depth; });

                // Add breadcrumb and label for entering nodes.
                var entering = g.enter().append("svg:g");

                entering.append("svg:polygon")
                        .attr("points", breadcrumbPoints)
                        .style("fill", function(d) {
                            console.log(d)
                            if(colors[d.name]!=undefined){
                                return colors[d.name]
                            } else if (d.parent!=undefined && colors[d.parent.name]!=undefined){
                                return colors[d.parent.name];
                            } else {
                                return;
                            }
                        })

                entering.append("svg:text")
                        .attr("x", (b.w + b.t) / 2)
                        .attr("y", b.h / 2)
                        .attr("dy", "0.35em")
                        .attr("text-anchor", "middle")
                        .text(function(d) { return d.name; });

                // Set position for entering and updating nodes.
                g.attr("transform", function(d, i) {
                    return "translate(" + i * (b.w + b.s) + ", 0)";
                });

                // Remove exiting nodes.
                g.exit().remove();

                // Now move and update the percentage at the end.
                d3.select("#trail").select("#endlabel")
                        .attr("x", (nodeArray.length + 0.5) * (b.w + b.s))
                        .attr("y", b.h / 2)
                        .attr("dy", "0.35em")
                        .attr("text-anchor", "middle")
                        .text(percentageString);

                // Make the breadcrumb trail visible, if it's hidden.
                d3.select("#trail")
                        .style("visibility", "");

            }

            function drawLegend() {

                // Dimensions of legend item: width, height, spacing, radius of rounded rect.
                var li = {
                    w: 200, h: 30, s: 3, r: 3
                };

                var legend = d3.select("#legend").append("svg:svg")
                        .attr("width", li.w)
                        .attr("height", d3.keys(colors).length * (li.h + li.s));

                var g = legend.selectAll("g")
                        .data(d3.entries(colors))
                        .enter().append("svg:g")
                        .attr("transform", function(d, i) {
                            return "translate(0," + i * (li.h + li.s) + ")";
                        });

                g.append("svg:rect")
                        .attr("rx", li.r)
                        .attr("ry", li.r)
                        .attr("width", li.w)
                        .attr("height", li.h)
                        .style("fill", function(d) { return d.value; });

                g.append("svg:text")
                        .attr("x", li.w / 2)
                        .attr("y", li.h / 2)
                        .attr("dy", "0.35em")
                        .attr("text-anchor", "middle")
                        .text(function(d) { return d.key; });
            }

            function toggleLegend() {
                var legend = d3.select("#legend");
                if (legend.style("visibility") == "hidden") {
                    legend.style("visibility", "");
                } else {
                    legend.style("visibility", "hidden");
                }
            }

            // Take a 2-column CSV and transform it into a hierarchical structure suitable
            // for a partition layout. The first column is a sequence of step names, from
            // root to leaf, separated by hyphens. The second column is a count of how
            // often that sequence occurred.
            function buildHierarchy(csv) {




                csv = (_.filter(csv, function(o) {return o['CodeExt'] === window._selectedCountry.id}))[0];

                var root = {
                    "name": "root",
                    "children": [
                        {"name":"Personal care", "size":0, "children":[
                            {"name":"Sleep", "size":0, "children":[]},
                            {"name":"Eating", "size":0, "children":[]},
                            {"name":"Other personal care", "size":0, "children":[]}
                        ]},
                        {"name":"Employment", "size":0, "children":[
                            {"name":"Commuting", "size":0, "children":[]},
                            {"name":"Employment Activities", "size":0, "children":[]}
                        ]},
                        {"name":"Study", "size":0, "children":[
                            {"name":"At school and university", "size":0, "children":[]},
                            {"name":"Homework", "size":0, "children":[]}
                        ]},

                        {"name":"Household and family care", "size":0, "children":[
                            {"name":"Food management", "size":0, "children":[]},
                            {"name":"Dish washing", "size":0, "children":[]},
                            {"name":"House cleaning", "size":0, "children":[]},
                            {"name":"Household upkeep", "size":0, "children":[]},
                            {"name":"Laundry", "size":0, "children":[]},
                            {"name":"Ironing", "size":0, "children":[]},
                            {"name":"Textile care", "size":0, "children":[]},
                            {"name":"Gardening", "size":0, "children":[]},
                            {"name":"Caring for pets", "size":0, "children":[]},
                            {"name":"Construction and repairs", "size":0, "children":[]},
                            {"name":"Errands", "size":0, "children":[]},
                            {"name":"Childcare", "size":0, "children":[]},
                            {"name":"Instructional childcare", "size":0, "children":[]},
                            {"name":"Household member care", "size":0, "children":[]}
                        ]},
                        {"name":"Leisure and social life", "size":0, "children":[
                            {"name":"Organizing", "size":0, "children":[]},
                            {"name":"Neighbor care", "size":0, "children":[]},
                            {"name":"Participatory activities", "size":0, "children":[]},
                            {"name":"Visiting and feasts", "size":0, "children":[]},
                            {"name":"Entertainment and culture", "size":0, "children":[]},
                            {"name":"Resting", "size":0, "children":[]},
                            {"name":"Walking and hiking", "size":0, "children":[]},
                            {"name":"Sports and outdoor activities", "size":0, "children":[]},
                            {"name":"Computer games", "size":0, "children":[]},
                            {"name":"Computing", "size":0, "children":[]},
                            {"name":"Hobbies and games", "size":0, "children":[]},
                            {"name":"Reading books", "size":0, "children":[]},
                            {"name":"Other reading", "size":0, "children":[]},
                            {"name":"TV and video", "size":0, "children":[]},
                            {"name":"Radio and music", "size":0, "children":[]},
                            {"name":"Travel related to study", "size":0, "children":[]},
                            {"name":"Travel related to shopping and services", "size":0, "children":[]}
                        ]}
                    ]
                };

                _(root.children).forEach(function(item){
                    item.size = timeToMinutes(csv[item.name]);
                    _(item.children).forEach(function(childitem){
                        childitem.size = timeToMinutes(csv[childitem.name]);
                    })
                })

                return root;

            };



        }


    </script>

    <script>


        function timeToMinutes(time){
            return moment.duration(time).asMinutes();
        }

        function minutesToTime(minutes){
            //return numeral(minutes).format('h:mm');
            var spl=numeral(minutes).format('hh:mm').split(':');
            return(spl[1]+'h '+spl[2]+'m')
        }

        d3.selectAll('#maleButton').on('click', function(data) {
            console.log('male');
            window._selectedGender="male";
            $(function() {
                $('html, body').stop().animate({
                    scrollTop: $('#services').offset().top
                }, 1500, 'easeInOutExpo');
            });
        });

        d3.selectAll('#femaleButton').on('click', function(data) {
            console.log('female');
            window._selectedGender="female";
            $(function() {
                $('html, body').stop().animate({
                    scrollTop: $('#services').offset().top
                }, 1500, 'easeInOutExpo');
            });
        });

        Happiness.init(window._selectedGender);
        var promisesLand = Happiness.load().then(function() {

          console.log(731, Happiness.activityFields);
          console.log(732, Happiness.activityData);

          userData.init(Happiness.activityFields, Happiness.activityData);

          timeUse.init(Happiness.dataSet);
        });

        var loadKnop = promisesLand.then(function() {
            // try {
                var param1 = userData.getCurrentActivity();
                console.log(736, param1);
                var param2 = userData.getCurrentActivityNr();
                console.log(738, param2);
                var param3 = Happiness.activityData;
                console.log(740, param3);
                var param4 = Happiness.activityFields;
                console.log(742, param4);

                circleKnop.init(
                    param1,
                    param2,
                    param3,
                    param4
                );

                console.log(748, Happiness.dataSet);
                timeUse.draw();
                //timeUse.init(Happiness.dataSet);
            // } catch(e) {
                // console.error(e.message);
            // }
        });

    </script>



</body>

</html>
